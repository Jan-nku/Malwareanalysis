include ".\includes\IsPE.yar"
include ".\includes\SizeLimit.yar"
import "pe"

rule Lab3_1
{
	strings:
	$string1 = "www.practicalmalwareanalysis.com" wide ascii
	$string2 = "vmx32to64.exe" wide ascii
	$string3 = "VideoDriver" wide ascii
	condition:	
	IsPE and SizeLimit and all of ($string*)

}

rule Lab3_2
{
	strings:
	$string1 = "IPRIP" wide ascii
	$string2 = "INA+" wide ascii
	$string3 = "Svchost" wide ascii
	$string4 = "Windows XP 6.11" wide ascii
	condition:	
	IsPE and SizeLimit and all of ($string*)
}  

rule Lab3_3
{
	strings:
	$string1 = "\\svchost.exe" wide ascii
	$string2 = "<program name unknown>" wide ascii
	$string3 = "lowio" wide ascii
	condition:	
	IsPE and SizeLimit and all of ($string*)
}  

rule Lab3_4
{
	strings:
	$string1 = "SOFTWARE\\Microsoft \\XPS" wide ascii
	$string2 = "HTTP" wide ascii
	$string3 = ">> NUL" wide ascii
	$string4 = "-cc" wide ascii
	condition:	
	IsPE and SizeLimit and all of ($string*)
}  

