include ".\includes\IsPE.yar"
include ".\includes\SizeLimit.yar"

rule Lab7_1
{
    strings:
		$string1 = "Malservice" wide ascii
		$string2 = "HGL345" wide ascii
		$string3 = "malwareanalysisbook.com" wide ascii
		$string4 = "Explorer 8.0" wide ascii

    condition:
		IsPE and SizeLimit and (all of ($string*))
}

rule Lab7_2
{
    strings:
		$string1 = "malwareanalysisbook.com/ad.html" wide ascii

    condition:
		IsPE and SizeLimit and $string1
}

rule Lab7_3_dll
{
    strings:
		$string1 = "SADFHUHF" wide ascii
		$string2 = "exec" wide ascii
		$string3 = "hello" wide ascii
		$string4 = "127.26.152.13" wide ascii

    condition:
		IsPE and SizeLimit and (all of ($string*))
}

rule Lab7_3
{
    strings:
		$string1 = "kerne1" wide ascii
		$string2 = ".exe" wide ascii
		$string3 = "C:\\*" wide ascii
		$string4 = "WARNING_THIS_WILL_DESTROY_YOUR_MACHINE" wide ascii

    condition:
		IsPE and SizeLimit and (all of ($string*))
}


