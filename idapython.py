import idc 
import idautils 
import idaapi 
import time

# find string "VMXh"
pattern = '68 58 4D 56'
addr = MinEA()
for x in range(0, 5):
	addr = FindBinary(addr,SEARCH_DOWN|SEARCH_NEXT,pattern)
	if addr != idc.BADADDR:
		print("VMXh 0x%x %s" % (addr,GetDisasm(addr)))


# Xrefs to 'in'
def GetStr(start,end):
    for addr in range(start,end):
        if GetMnem(addr)=='in':
            print hex(addr)
            Jump(addr)
            for refhs in XrefsTo(addr,flags=0):
                print "refhs: %s refhs.frm 0x%x"%(refhs,refhs.frm)

for seg in Segments():
    if SegName(seg) == '.text':
        GetStr(seg,SegEnd(seg))



	

